/*
*  A lexer implementation for the LibreSignage markup parser.
*  The token definitions are in tokens.js.
*/

var lexeme = require('./lexeme.js');
var tokens = require('./tokens.js');
var util = require('util');

module.exports.process = function(str) {
	let ret = [];
	let pos = 0;
	let index = 0;
	let lexeme = null;

	while (pos < str.length) {
		lexeme = null;
		for (let tm of tokens.TOKENS) {
			lexeme = tm.matcher(str, pos, index, ret);
			if (lexeme) {
				pos += lexeme.raw.length;
				ret.push(lexeme);
				index++;
				break;
			}
		}
		if (!lexeme) { break; }
	}
	return ret;
}
