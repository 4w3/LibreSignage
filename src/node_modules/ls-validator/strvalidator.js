var $ = require('jquery');
var BaseValidator = require('./basevalidator.js');

module.exports = class StrValidator extends BaseValidator {
	/*
	*  Validate string inputs.
	*
	*  Settings:
	*    * min = The minimum length.    (integer)
	*    * max = The maximum length.    (integer)
	*    * regex = A "whitelist" regex. (regex)
	*/
	constructor(...args) {
		super(...args);
		this.chk_settings(['min', 'max', 'regex']);
	}

	validate(selector) {
		var val = null;
		var min = this.settings.min;
		var max = this.settings.max;
		var regex = this.settings.regex;
		var a, b, c;
		var ret = true;
		var tmp = null;

		selector.query.each(function() {
			val = $(this).val();
			a = (min == null || val.length >= min);
			b = (max == null || val.length <= max);
			if (regex == null) {
				c = true;
			} else {
				tmp = val.match(regex);
				c = (tmp && tmp[0].length == val.length);
			}
			ret = a && b && c;
			if (!ret) { return false; }
		});
		return ret;
	}
}
