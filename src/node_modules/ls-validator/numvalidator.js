var $ = require('jquery');
var BaseValidator = require('./basevalidator.js');

module.exports = class NumValidator extends BaseValidator {
	/*
	*  Validate numeric inputs.
	*
	*  Settings:
	*    * min = The minimum value.    (number)
	*    * max = The maximum value.    (number)
	*    * nan = Allow NaN values.     (boolean)
	*    * float = Allow float values. (boolean)
	*/
	constructor(...args) {
		super(...args);
		this.chk_settings(['min', 'max', 'nan', 'float']);
	}

	validate(selector) {
		var val = null;
		var min = this.settings.min;
		var max = this.settings.max;
		var nan = this.settings.nan;
		var float = this.settings.float;
		var a, b;
		var ret = true;
		selector.query.each(function() {
			if (float) {
				val = parseFloat($(this).val());
			} else {
				if ($(this).val().indexOf('.') != -1) {
					ret = false;
					return false;
				}
				val = parseInt($(this).val(), 10);
			}
			if (isNaN(val) && !nan) {
				ret = false;
				return false;
			} else if (isNaN(val) && nan) {
				ret = true;
				return false;
			}
			a = (min == null || val >= min);
			b = (max == null || val <= max);
			ret = a && b;
		});
		return ret;
	}
}
